# 13.1 ⭐스코프란?
> 식별자가 유효한 범위
+ 모든 식별자는 자신이 선언된 위치에 의해 다른 코드가 식별자 자신을 참조할 수 있는 유효 범위가 결정된다
+ 아래 코드와 같이 js 엔진은 스코프를 통해 두 x 변수 중 어떤 변수를 참조해야 할 것인지 결정하는데 이를 `식별자 결정`이라 한다<br/>
  → 스코프는 js 엔진이 `식별자를 결정할 때 사용하는 규칙`이다
```js
// 전역 스코프
var x = 'global'; 

// 함수 스코프
function foo(){
    var x = 'local';
    console.log(x); // ✔️local
}

foo();

console.log(x); // ✔️global

// → 두 x는 이름이 동일한 식별자이지만 스코프가 다른 별개의 변수이다 
```
+ js 엔진은 코드 실행시 코드의 문맥을 고려해 렉시컬 환경에 따라 위 코드처럼 동일한 코드도 다른 결과를 만들어 낸다 
```
🗒️ 코드의 문맥과 환경
- 렉시컬 환경 : 코드가 어디서 실행되며 주변에 어떤 코드가 있는지
- 코드의 문맥은 렉시컬 환경으로 이루어지며 이를 구현한 것이 '실행 컨텍스트'이다
- 모든 코드는 실행 컨텍스트에서 평가되고 실행되며 스코프는 실행 컨텍스트와 깊은 관련이 있다 
```
+ 스코프 내에서는 식별자는 유일해야 하지만 다른 스코프에서는 같은 이름의 식별자를 사용할 수 있다
```js
⚠️ var 키워드로 선언한 변수의 중복 선언

 function foo() {
// ✔️var로 선언된 변수는 같은 스코프 내 중복 선언이 허용⭕ (let, const는 허용❌)
// → 의도치 않게 변수값이 재할당되어 변경되는 부작용 발생 시킴
    var x = 1;
    var x = 2; // 이 변수 선언문은 js 엔진에 의해 var 키워드가 없는 것처럼 동작
    console.log(x); // 2
}

foo();
```
___
<br/><br/>
# 13.2 스코프의 종류
## 13.2.1 전역과 전역 스코프
> 전역은 코드의 가장 바깥 영역을 말하며 전역 스코프를 만든다 
+ 전역 변수는 어디서든지 참조할 수 있다 (함수 내부에서도 참조 가능) 
## 13.2.2 지역과 지역 스코프
> 지역은 함수 몸체 내부를 말한다 
+ 지역 변수는 자신의 지역 스코프와 하위 지역(중첩 함수) 스코프에서 유효하다 
___
<br/><br/>
# 13.3 스코프 체인
> 스코프가 계층적으로 연결된 것
+ 상위 스코프에서 선언한 변수를 하위 스코프에서도 참조할 수 있는 이유?<br/>
  → 변수를 참조할 때 js 엔진은 스코프 체인을 통해 `변수를 참조하는 코드의 스코프에서 시작하여 상위 스코프 방향으로 이동`하며 선언된 변수를 검색한다
+ js 엔진은 코드를 실행하기에 앞서 렉시컬 환경을 실제로 생성한다
```
> 스코프 체인은 실행 컨텍스트의 렉시컬 환경을 단방향으로 연결한 것
- 전역 렉시컬 환경은 코드가 로드되면 곧바로 생성되고 함수의 렉시컬 환경은 함수가 호출되면 곧바로 생성된다 (ㄴ23.실행 컨텍스트) 
```
___
<br/><br/>
## 13.3.1 스코프 체인에 의한 변수 검색
+ js 엔진은 스코프 체인을 통해 변수를 참조하는 코드의 스코프에서 시작하여 상위 스코프 방향으로 이동하며 선언된 변수를 검색하며<br/>
  ⚠️ 절대 하위 스코프로 내려가면서 식별자를 검색할 일❌
+ 상위 스코프에서 유효한 변수 : 하위 스코프에서 자유롭게 참조 가능⭕<br/>
+ 하위 스코프에서 유효한 변수 : 상위 스코프에서 참조 불가❌
___
## 13.3.2 스코프 체인에 의한 함수 검색
```js
// 전역 함수
function foo(){
    console.log('global function foo'); 
}

function bar(){
    // 중첩 함수
    function foo(){
        console.log('local function foo');
    }
    foo(); //여기서 foo 함수 호출 시 js 엔진은 함수 호출하기 위해 함수 가리키는 식별자 foo 검색
}

bar(); // ✔️local function foo
```
+ 함수도 식별자에 할당되므로 스코프를 가진다
```
스코프 = '식별자를 검색하는 규칙'
```
___
<br/><br/>
# 13.4 ⭐함수 레벨 스코프 
> 코드 블록이 아닌 함수의 코드 블록(함수 몸체)만을 지역 스코프로 인정하는 것 
+ var 키워드로 선언된 변수는 오로지 `함수의 코드 블록만을` 지역 스코프로 인정한다 
```js
var x = 1;

if(true){
    // 함수 밖에서 var 키워드로 선언된 변수는 코드 블록 내 선언되었다할지라도 모두 전역 변수다
    // 이는 의도치않게 변수값이 변경되는 부작용을 발생시킨다 
    var x = 10;
}

console.log(x); // 10
```
+ let, const 키워드는 블록 레벨 스코프(`모든 코드 블록이` 지역 스코프 만듬)를 지원한다
___
<br/><br/>
# 13.5 렉시컬 스코프
> ⭐함수를 어디서 호출했는지가 아니라 `함수를 어디서 정의했는지`에 따라 상위 스코프 결정되는 방식<br/>
+ 함수가 호출된 위치는 상위 스코프 결정에 어떠한 영향 주지 ❌ 
```js
var x = 1;

function foo() {
    var x = 10;
    bar();
}

function bar(){
    console.log(x);
}

foo(); // ✔️1
bar(); // ✔️1

// bar 함수 호출시 호출된 곳이 어디인지에 관계없이 언제나 자신이 기억하고 있는 전역 스코프(자신이 정의된 스코프)를 상위 스코프로 사용 
```


